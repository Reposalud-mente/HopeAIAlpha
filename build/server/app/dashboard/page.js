(()=>{var e={};e.id=5105,e.ids=[5105],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},53282:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=s(51168),r=s(35807),n=s(18359),l=s.n(n),i=s(2728),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8474)),"C:\\Users\\david\\clinical-dashboard-app\\consolidated-app\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,25970)),"C:\\Users\\david\\clinical-dashboard-app\\consolidated-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,45589,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,59160,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,41593,23)),"next/dist/client/components/unauthorized-error"]}],c=["C:\\Users\\david\\clinical-dashboard-app\\consolidated-app\\src\\app\\dashboard\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},84950:(e,t,s)=>{Promise.resolve().then(s.bind(s,8474))},8510:(e,t,s)=>{Promise.resolve().then(s.bind(s,42619))},42619:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ec});var a=s(22628),r=s(56093),n=s(24189),l=s(1080),i=s(41918),o=s(72517),d=s(14404),c=s(5231),u=s(19648);function p({children:e}){return(0,a.jsx)("div",{children:e})}function x(e){return(0,a.jsx)("input",{className:"w-full border-b px-2 py-1 mb-2",...e})}function m({children:e}){return(0,a.jsx)("div",{className:"text-gray-400 px-2 py-1",children:e})}function h({children:e}){return(0,a.jsx)("div",{className:"py-1",children:e})}function f({children:e,value:t,onSelect:s}){return(0,a.jsx)("div",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-blue-50 rounded",tabIndex:0,role:"option","aria-selected":!1,onClick:s,children:e})}var v=s(64927),b=s(93208),j=s(61180),g=s(82839),y=s(42837),N=s(41309),w=s(76118),P=s(81982),C=s(70329),A=s(73008),I=s(32411),R=s(93806),S=s(81448),_=s(67376),k=s(55201),D="Popover",[O,$]=(0,j.A)(D,[P.Bk]),E=(0,P.Bk)(),[T,M]=O(D),F=e=>{let{__scopePopover:t,children:s,open:n,defaultOpen:l,onOpenChange:i,modal:o=!1}=e,d=E(t),c=r.useRef(null),[u,p]=r.useState(!1),[x=!1,m]=(0,S.i)({prop:n,defaultProp:l,onChange:i});return(0,a.jsx)(P.bL,{...d,children:(0,a.jsx)(T,{scope:t,contentId:(0,w.B)(),triggerRef:c,open:x,onOpenChange:m,onOpenToggle:r.useCallback(()=>m(e=>!e),[m]),hasCustomAnchor:u,onCustomAnchorAdd:r.useCallback(()=>p(!0),[]),onCustomAnchorRemove:r.useCallback(()=>p(!1),[]),modal:o,children:s})})};F.displayName=D;var q="PopoverAnchor";r.forwardRef((e,t)=>{let{__scopePopover:s,...n}=e,l=M(q,s),i=E(s),{onCustomAnchorAdd:o,onCustomAnchorRemove:d}=l;return r.useEffect(()=>(o(),()=>d()),[o,d]),(0,a.jsx)(P.Mz,{...i,...n,ref:t})}).displayName=q;var L="PopoverTrigger",G=r.forwardRef((e,t)=>{let{__scopePopover:s,...r}=e,n=M(L,s),l=E(s),i=(0,b.s)(t,n.triggerRef),o=(0,a.jsx)(I.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":Y(n.open),...r,ref:i,onClick:(0,v.m)(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?o:(0,a.jsx)(P.Mz,{asChild:!0,...l,children:o})});G.displayName=L;var U="PopoverPortal",[Z,z]=O(U,{forceMount:void 0}),B=e=>{let{__scopePopover:t,forceMount:s,children:r,container:n}=e,l=M(U,t);return(0,a.jsx)(Z,{scope:t,forceMount:s,children:(0,a.jsx)(A.C,{present:s||l.open,children:(0,a.jsx)(C.Z,{asChild:!0,container:n,children:r})})})};B.displayName=U;var V="PopoverContent",K=r.forwardRef((e,t)=>{let s=z(V,e.__scopePopover),{forceMount:r=s.forceMount,...n}=e,l=M(V,e.__scopePopover);return(0,a.jsx)(A.C,{present:r||l.open,children:l.modal?(0,a.jsx)(H,{...n,ref:t}):(0,a.jsx)(X,{...n,ref:t})})});K.displayName=V;var W=(0,R.TL)("PopoverContent.RemoveScroll"),H=r.forwardRef((e,t)=>{let s=M(V,e.__scopePopover),n=r.useRef(null),l=(0,b.s)(t,n),i=r.useRef(!1);return r.useEffect(()=>{let e=n.current;if(e)return(0,_.Eq)(e)},[]),(0,a.jsx)(k.A,{as:W,allowPinchZoom:!0,children:(0,a.jsx)(J,{...e,ref:l,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,v.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),i.current||s.triggerRef.current?.focus()}),onPointerDownOutside:(0,v.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey,a=2===t.button||s;i.current=a},{checkForDefaultPrevented:!1}),onFocusOutside:(0,v.m)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),X=r.forwardRef((e,t)=>{let s=M(V,e.__scopePopover),n=r.useRef(!1),l=r.useRef(!1);return(0,a.jsx)(J,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(n.current||s.triggerRef.current?.focus(),t.preventDefault()),n.current=!1,l.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(n.current=!0,"pointerdown"!==t.detail.originalEvent.type||(l.current=!0));let a=t.target;s.triggerRef.current?.contains(a)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&l.current&&t.preventDefault()}})}),J=r.forwardRef((e,t)=>{let{__scopePopover:s,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:l,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:u,...p}=e,x=M(V,s),m=E(s);return(0,y.Oh)(),(0,a.jsx)(N.n,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:l,children:(0,a.jsx)(g.qW,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>x.onOpenChange(!1),children:(0,a.jsx)(P.UC,{"data-state":Y(x.open),role:"dialog",id:x.contentId,...m,...p,ref:t,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Q="PopoverClose";function Y(e){return e?"open":"closed"}function ee({open:e,onOpenChange:t,children:s}){return(0,a.jsx)(F,{open:e,onOpenChange:t,children:s})}r.forwardRef((e,t)=>{let{__scopePopover:s,...r}=e,n=M(Q,s);return(0,a.jsx)(I.sG.button,{type:"button",...r,ref:t,onClick:(0,v.m)(e.onClick,()=>n.onOpenChange(!1))})}).displayName=Q,r.forwardRef((e,t)=>{let{__scopePopover:s,...r}=e,n=E(s);return(0,a.jsx)(P.i3,{...n,...r,ref:t})}).displayName="PopoverArrow";let et=r.forwardRef(({className:e,...t},s)=>(0,a.jsx)(B,{children:(0,a.jsx)(K,{ref:s,className:"z-50 rounded-md border bg-white p-2 shadow-lg outline-none "+(e??""),...t})}));et.displayName=K.displayName;let es=[{value:"objetivos",label:"Sugerir objetivos para la sesi\xf3n"},{value:"resumen",label:"Resumir historia cl\xednica relevante"},{value:"preguntas",label:"Proponer preguntas o actividades"}];function ea(){let[e,t]=r.useState(!1),[s,n]=r.useState("");return(0,a.jsxs)(ee,{open:e,onOpenChange:t,children:[(0,a.jsx)(G,{asChild:!0,children:(0,a.jsx)("button",{type:"button",className:"p-2 rounded-full bg-gray-100 hover:bg-blue-100 text-blue-600 transition flex items-center","aria-label":"AI puede asistir en la preparaci\xf3n",children:(0,a.jsx)(d.A,{className:"w-5 h-5"})})}),(0,a.jsx)(et,{className:"w-72 p-0",children:(0,a.jsxs)(p,{children:[(0,a.jsx)(x,{placeholder:"Selecciona tarea AI..."}),(0,a.jsx)(m,{children:"No hay tareas AI"}),(0,a.jsx)(h,{children:es.map(e=>(0,a.jsxs)(f,{value:e.value,onSelect:()=>{n(e.value),t(!1)},children:[(0,a.jsx)(c.A,{className:(0,u.cn)("mr-2 h-4 w-4",s===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})})]})}var er=s(68910);let en=e=>{let t;let s=new Set,a=(e,a)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=a?a:"object"!=typeof r||null===r)?r:Object.assign({},t,r),s.forEach(s=>s(t,e))}},r=()=>t,n={setState:a,getState:r,getInitialState:()=>l,subscribe:e=>(s.add(e),()=>s.delete(e))},l=t=e(a,r,n);return n},el=e=>e?en(e):en,ei=e=>e,eo=e=>{let t=el(e),s=e=>(function(e,t=ei){let s=r.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return r.useDebugValue(s),s})(t,e);return Object.assign(s,t),s},ed=(e=>e?eo(e):eo)((e,t)=>({userId:"",selectedPatientId:null,dashboardSummary:null,patients:[],appointments:[],messages:[],setUserId:t=>e({userId:t}),setSelectedPatientId:t=>e({selectedPatientId:t}),fetchDashboardSummary:async()=>{let{userId:s}=t(),a=await fetch(`/api/dashboard/summary?userId=${s}`,{credentials:"same-origin"});e({dashboardSummary:await a.json()})},fetchPatients:async()=>{let{userId:s}=t(),a=await fetch(`/api/patients?userId=${s}`,{credentials:"same-origin"}),r=await a.json();e({patients:Array.isArray(r)?r:r.patients||[]})},fetchAppointments:async()=>{let{userId:s}=t(),a=await fetch(`/api/appointments?userId=${s}`,{credentials:"same-origin"});e({appointments:await a.json()})},fetchMessages:async()=>{let{userId:s}=t(),a=await fetch(`/api/messages?userId=${s}`,{credentials:"same-origin"});e({messages:await a.json()})}}));function ec(){let{user:e}=(0,n.A)(),{userId:t,dashboardSummary:s,patients:r,appointments:d,messages:c,fetchDashboardSummary:u,fetchPatients:p,fetchAppointments:x,fetchMessages:m,setUserId:h}=ed(),f=new Date,v=new Set,b=d.filter(e=>new Date(e.date)>f).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()).filter(e=>!v.has(e.patientId)&&(v.add(e.patientId),!0)).slice(0,3);return s?.totalAppointments,(0,a.jsx)(er.A,{children:(0,a.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Plataforma de Telemedicina"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Gestione sus consultas virtuales de manera eficiente"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsx)(i.Zp,{className:"flex flex-col justify-between bg-blue-50 border border-blue-100 shadow-none h-full",children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 justify-between h-full p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-1",children:(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Pacientes Activos"})}),(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-900 mt-2",children:s?.activePatients??0}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"en tratamiento"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-6 items-end",children:[(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"Todos los Pacientes"}),(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"M\xe9tricas"})]})]})}),(0,a.jsx)(i.Zp,{className:"flex flex-col justify-between bg-green-50 border border-green-100 shadow-none h-full",children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 justify-between h-full p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Sesiones Hoy"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-green-900 mt-2",children:s?.sessionsToday??0}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 mt-1",children:[s?.pendingEvaluations??0," evaluaciones pendientes"]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-6 items-end",children:[(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"Calendario"}),(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"To Do"})]})]})}),(0,a.jsx)(i.Zp,{className:"flex flex-col justify-between bg-purple-50 border border-purple-100 shadow-none h-full",children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 justify-between h-full p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"h-2 w-2 rounded-full bg-green-400 inline-block"}),(0,a.jsx)("span",{className:"font-semibold text-purple-900",children:"Listo para ayudar"})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Tu apoyo inteligente para documentaci\xf3n y consultas cl\xednicas"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-6 items-end",children:[(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"Consultar"}),(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"Generar Informe"})]})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(i.Zp,{children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{children:"Pr\xf3ximas Consultas"})}),(0,a.jsxs)(i.Wu,{children:[b.map(e=>{let t=Array.isArray(r)?r.find(t=>t.id===e.patientId):null;return(0,a.jsxs)("div",{className:"mb-4 p-4 border rounded-lg flex flex-col sm:flex-row sm:justify-between sm:items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:t?`${t.firstName} ${t.lastName}`:"Paciente"}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[(0,a.jsx)(o.A,{className:"w-4 h-4 mr-1 text-blue-500"}),(0,a.jsxs)("span",{children:[new Date(e.date).toLocaleDateString("es-CL",{weekday:"short",day:"numeric",month:"short"}),", ",new Date(e.date).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-row items-center mt-3 sm:mt-0 space-x-2",children:[(0,a.jsx)(l.$,{size:"sm",className:"bg-blue-600 text-white hover:bg-blue-700 font-semibold px-6 py-2 rounded-lg shadow",children:"Iniciar"}),(0,a.jsx)(ea,{})]})]},e.id)}),(0,a.jsx)(l.$,{variant:"outline",className:"w-full mt-2",children:"Ver Todas las Consultas"})]})]})}),(0,a.jsx)("div",{children:(0,a.jsx)(i.Zp,{className:"flex flex-col justify-between h-full bg-blue-50 border border-blue-100 shadow-none",children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 justify-between h-full p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Mensajes Recientes"}),(0,a.jsx)("p",{className:"text-xs text-blue-900 font-semibold mt-1",children:"Promueve la comunicaci\xf3n y el v\xednculo con tus pacientes"})]}),(0,a.jsx)("div",{className:"flex flex-col gap-2 mt-2",children:(()=>{let e=new Set,t=c.filter(t=>!e.has(t.patientId)&&(e.add(t.patientId),!0)).slice(0,2);return t.length>0?t.map(e=>{let t=r.find(t=>t.id===e.patientId);return(0,a.jsxs)("div",{className:"p-3 rounded-lg bg-white border border-blue-100",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,a.jsx)("p",{className:"font-medium text-blue-900",children:t?`${t.firstName} ${t.lastName}`:"Paciente"}),(0,a.jsx)("span",{className:"text-xs text-blue-700",children:new Date(e.sentAt).toLocaleTimeString("es-CL")})]}),(0,a.jsx)("p",{className:"text-sm text-blue-800 italic truncate",children:e.content?.trim()?e.content:"Mensaje de v\xednculo terap\xe9utico"})]},e.id)}):(0,a.jsx)("div",{className:"text-sm text-blue-400 italic",children:"No hay mensajes recientes"})})()})]}),(0,a.jsx)("div",{className:"flex items-end mt-6",children:(0,a.jsx)(l.$,{variant:"outline",className:"flex-1",children:"Ver Todos los Mensajes"})})]})})})]})]})})}},8474:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(5596).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\david\\\\clinical-dashboard-app\\\\consolidated-app\\\\src\\\\app\\\\dashboard\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\david\\clinical-dashboard-app\\consolidated-app\\src\\app\\dashboard\\page.tsx","default")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5290,7796,3271,4580,4287,7648,8910],()=>s(53282));module.exports=a})();